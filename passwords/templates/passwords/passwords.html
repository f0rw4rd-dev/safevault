{% load static %}

<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <title>SafeVault | Пароли</title>

    {% include 'head.html' %}
</head>

<body id="page-top">
<div id="wrapper">
    {% include 'sidebar.html' %}

    <div class="d-flex flex-column" id="content-wrapper">
        <div id="content">
            {% include 'navbar.html' %}

            <div class="container-fluid py-2 py-xl-2">
                <div class="card border rounded mb-3">
                    <div class="card-header py-3">
                        <div class="row">
                            <div class="col-12 col-sm-12 col-md-auto col-lg-auto col-xl-auto col-xxl-auto col-auto">
                                <h2 class="text-dark mb-0" style="font-weight: bold;">Пароли</h2>
                            </div>
                            <div class="col-12 col-sm-12 col-md col-lg col-xl-auto col-xxl-auto col-auto">
                                <div class="btn-group" role="group">
                                    <button class="btn link-dark zoom ps-0 border-0 btn-favorite" type="button">
                                        <i class="far fa-star fs-4 align-text-bottom"></i>
                                    </button>
                                    <button class="btn link-dark zoom border-0 btn-trash" type="button">
                                        <i class="far fa-trash-alt fs-4 align-text-bottom"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl col-xxl d-flex justify-content-start justify-content-sm-start justify-content-md-start justify-content-lg-start justify-content-xl-end justify-content-xxl-end me-0">
                                <div>
                                    <a class="btn btn-dark btn-sm my-1 ms-0 me-2 me-sm-1" role="button" href="#" data-bs-toggle="modal" data-bs-target="#modal-add-password">
                                        <i class="fas fa-plus fa-sm text-white-50"></i>&nbsp; Добавить
                                    </a>
                                    <a class="btn btn-dark btn-sm my-1 mx-0 ms-sm-1" role="button" href="#">
                                        <i class="fas fa-file-export fa-sm text-white-50"></i>&nbsp; Экспорт
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row gy-4 row-cols-1 row-cols-md-2 row-cols-xl-4 row-cols-xxl-5 p-2">
                            {% for password in passwords %}
                                <div class="col">
                                    <div class="card border rounded">
                                        <div class="card-header">
                                            {% if password.website %}
                                                <h5 class="text-dark mb-0 mt-1 record_password" id="id_text_title_{{ password.id }}" data-init-vector="{{ password.init_vector }}">{{ password.title }}</h5>
                                                <a class="record_password" id="id_text_website_{{ password.id }}" data-init-vector="{{ password.init_vector }}" href="{{ password.website }}">{{ password.website }}</a>
                                            {% endif %}
                                        </div>
                                        <div class="card-body text-center py-4">
                                            <form>
                                                <div class="input-group input-group-sm">
                                                    <input class="form-control record_password" type="text" readonly="" id="id_text_login_{{ password.id }}" value="{{ password.login }}" data-init-vector="{{ password.init_vector }}" style="color: var(--bs-dark);">
                                                    <button class="btn btn-dark btn-copy" type="button">
                                                        <i class="far fa-copy"></i>
                                                    </button>
                                                </div>
                                                <div class="input-group input-group-sm mt-2">
                                                    <input class="form-control record_password" type="password" readonly="" id="id_text_password_{{ password.id }}" value="{{ password.password }}" data-init-vector="{{ password.init_vector }}" style="color: var(--bs-dark);">
                                                    <button class="btn btn-dark btn-copy" type="button">
                                                        <i class="far fa-copy"></i>
                                                    </button>
                                                </div>
                                            </form>
                                            <hr>
                                            <div class="btn-group" role="group">
                                                <button class="btn link-dark zoom border-0" type="button">
                                                    <i class="fas fa-expand-alt fs-5"></i>
                                                </button>
                                                <button class="btn link-dark zoom border-0" type="button">
                                                    <i class="far fa-star fs-5"></i>
                                                </button>
                                                <button class="btn link-dark zoom border-0" type="button">
                                                    <i class="far fa-trash-alt fs-5"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-6 align-self-center">
                                <p id="dataTable_info-1" class="dataTables_info" role="status" aria-live="polite">Показано {{ passwords.start_index }} до {{ passwords.end_index }} из {{ passwords.paginator.count }}</p>
                            </div>
                            <div class="col-md-6">
                                <nav class="d-lg-flex justify-content-lg-end dataTables_paginate paging_simple_numbers">
                                    <ul class="pagination">
                                        {% if passwords.has_previous %}
                                            <li class="page-item"><a class="page-link" href="?page={{ passwords.previous_page_number }}" aria-label="Previous"><span aria-hidden="true">«</span></a></li>
                                        {% else %}
                                            <li class="page-item disabled"><span class="page-link" aria-label="Previous"><span aria-hidden="true">«</span></span></li>
                                        {% endif %}

                                        {% for num in passwords.paginator.page_range %}
                                            {% if passwords.number == num %}
                                                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                                            {% elif num > passwords.number|add:'-3' and num < passwords.number|add:'3' %}
                                                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                                            {% endif %}
                                        {% endfor %}

                                        {% if passwords.has_next %}
                                            <li class="page-item"><a class="page-link" href="?page={{ passwords.next_page_number }}" aria-label="Next"><span aria-hidden="true">»</span></a></li>
                                        {% else %}
                                            <li class="page-item disabled"><span class="page-link" aria-label="Next"><span aria-hidden="true">»</span></span></li>
                                        {% endif %}
                                    </ul>
                                </nav>
                            </div>
                        </div>

                        {#                        <div class="row mt-3">#}
                        {#                            <div class="col-md-6 align-self-center">#}
                        {#                                <p id="dataTable_info-1" class="dataTables_info" role="status" aria-live="polite">Показано от 1 до 10 из 27</p>#}
                        {#                            </div>#}
                        {#                            <div class="col-md-6">#}
                        {#                                <nav class="d-lg-flex justify-content-lg-end dataTables_paginate paging_simple_numbers">#}
                        {#                                    <ul class="pagination">#}
                        {#                                        <li class="page-item disabled"><a class="page-link" aria-label="Previous" href="#"><span aria-hidden="true">«</span></a></li>#}
                        {#                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>#}
                        {#                                        <li class="page-item"><a class="page-link" href="#">2</a></li>#}
                        {#                                        <li class="page-item"><a class="page-link" href="#">3</a></li>#}
                        {#                                        <li class="page-item"><a class="page-link" aria-label="Next" href="#"><span aria-hidden="true">»</span></a></li>#}
                        {#                                    </ul>#}
                        {#                                </nav>#}
                        {#                            </div>#}
                        {#                        </div>#}
                    </div>
                </div>
            </div>
        </div>

        {% include 'footer.html' %}
    </div>
    <a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
</div>
<div class="modal fade" role="dialog" tabindex="-1" id="modal-add-password">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title text-black" style="font-weight: bold;">Добавление пароля</h4>
                <button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="id_form_add_password" method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label text-dark" for="{{ add_password_form.title.id_for_label }}">{{ add_password_form.title.label_tag }}
                            <span class="text-danger">&nbsp;*</span>
                        </label>
                        {{ add_password_form.title }}
                    </div>
                    <div class="mb-3">
                        <label class="form-label text-dark" for="{{ add_password_form.website.id_for_label }}">{{ add_password_form.website.label_tag }}</label>
                        {{ add_password_form.website }}
                    </div>
                    <div class="mb-3">
                        <label class="form-label text-dark" for="{{ add_password_form.login.id_for_label }}">{{ add_password_form.login.label_tag }}
                            <span class="text-danger">&nbsp;*</span>
                        </label>
                        {{ add_password_form.login }}
                    </div>
                    <div class="mb-3">
                        <label class="form-label text-dark" for="{{ add_password_form.email.id_for_label }}">{{ add_password_form.email.label_tag }}</label>
                        {{ add_password_form.email }}
                    </div>
                    <div class="mb-3">
                        <label class="form-label text-dark" for="{{ add_password_form.password.id_for_label }}">{{ add_password_form.password.label_tag }}
                            <span class="text-danger">&nbsp;*</span>
                        </label>
                        <div class="input-group">
                            {{ add_password_form.password }}
                            <button class="btn btn-dark" id="id_add_generate_password" type="button">
                                <i class="fa fa-gear"></i>
                            </button>
                        </div>
                        <small class="form-text" id="id_add_password_strength"></small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label text-dark" for="formAddPassword_extraData">Дополнительные данные</label>
                        {{ add_password_form.extra_data }}
                    </div>
                    {{ add_password_form.init_vector }}
                    <div class="mb-3">
                        <div class="form-check">
                            {{ add_password_form.favorite }}
                            {#                            <input class="form-check-input form-check-input-dark" type="checkbox" id="formAddPassword_favorite" name="formAddPassword[favorite]">#}
                            <label class="form-check-label text-dark" for="{{ add_password_form.favorite.id_for_label }}">{{ add_password_form.favorite.label_tag }}</label>
                        </div>
                    </div>
                    <hr>
                    <div>
                        <p class="text-dark"><span class="text-danger">*&nbsp;</span>- обязательные поля</p>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-light border rounded" type="button" data-bs-dismiss="modal">Закрыть</button>
                        <button class="btn btn-dark" type="submit">Выполнить</button>
                    </div>
                </form>
            </div>
            {#            <div class="modal-footer">#}
            {#                <button class="btn btn-light border rounded" type="button" data-bs-dismiss="modal">Закрыть</button>#}
            {#                <button class="btn btn-dark" type="submit">Выполнить</button>#}
            {#            </div>#}
        </div>
    </div>
</div>
<div class="modal fade" role="dialog" tabindex="-1" id="modal-edit-password">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title text-black" style="font-weight: bold;">Изменение пароля</h4>
                <button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="id_form_edit_password" method="post">
                    <div class="mb-3"><label class="form-label text-dark" for="formEditPassword_title">Заголовок<span class="text-danger">&nbsp;*</span></label><input class="form-control" type="text" id="formEditPassword_title" required="" maxlength="48" minlength="1" name="formEditPassword[title]"></div>
                    <div class="mb-3"><label class="form-label text-dark" for="formEditPassword_website">Веб-сайт</label><input class="form-control" type="text" id="formEditPassword_website" maxlength="256" name="formEditPassword[website]"></div>
                    <div class="mb-3"><label class="form-label text-dark" for="formEditPassword_login">Логин<span class="text-danger">&nbsp;*</span></label><input class="form-control" type="text" id="formEditPassword_login" maxlength="128" name="formEditPassword[login]"></div>
                    <div class="mb-3"><label class="form-label text-dark" for="formEditPassword_email">Адрес электронной почты</label><input class="form-control" type="email" id="formEditPassword_email" maxlength="128" name="formEditPassword[email]"></div>
                    <div class="mb-3"><label class="form-label text-dark" for="formEditPassword_password">Пароль<span class="text-danger">&nbsp;*</span></label>
                        <div class="input-group"><input class="form-control" type="password" id="formEditPassword_password" required="" maxlength="128" minlength="4" name="formEditPassword[password]">
                            <button class="btn btn-dark" id="id_edit_password_generator" type="button"><i class="fa fa-gear"></i></button>
                        </div>
                        <small class="form-text" id="id_edit_password_strength"></small>
                    </div>
                    <div class="mb-3"><label class="form-label text-dark" for="formEditPassword_extraData">Дополнительная информация</label><input class="form-control" type="text" id="formEditPassword_extraData" maxlength="4096" name="formEditPassword[extraData]"></div>
                    <div class="mb-3">
                        <div class="form-check"><input class="form-check-input form-check-input-dark" type="checkbox" id="formEditPassword_favorite" name="formEditPassword[favorite]"><label class="form-check-label text-dark" for="formEditPassword_favorite">Избранное</label></div>
                    </div>
                    <div><input class="form-control" type="hidden" id="formEditPassword_id" name="formEditPassword[id]" readonly=""></div>
                    <hr>
                    <div>
                        <p class="text-dark"><span class="text-danger">*&nbsp;</span>- обязательные поля</p>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-light border rounded" type="button" data-bs-dismiss="modal">Закрыть</button>
                <button class="btn btn-dark" type="button">Выполнить</button>
            </div>
        </div>
    </div>
</div>

{% include 'scripts.html' %}

<script src="{% static 'libraries/argon2-browser/dist/argon2-bundled.min.js' %}"></script>
<script src="{% static 'js/users.js' %}"></script>
<script src="{% static 'js/handlers/copyToClipboard.js' %}"></script>
<script src="{% static 'js/valid.js' %}"></script>
<script src="{% static 'js/passwords.js' %}"></script>
<script src="{% static 'js/handlers/passwords.js' %}"></script>
<script src="{% static 'js/encryption.js' %}"></script>
<script src="{% static 'js/pages/passwords.js' %}"></script>

<script>
    document.getElementById('user_email').textContent = getCookie('email');
</script>

{% if notification %}
    {% if notification.redirectUrl %}
        <script>{{ notification.func }}("{{ notification.text }}", "{{ notification.redirectUrl }}")</script>
    {% else %}
        <script>{{ notification.func }}("{{ notification.text }}")</script>
    {% endif %}
{% endif %}
</body>

</html>